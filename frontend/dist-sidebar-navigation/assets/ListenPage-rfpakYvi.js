import{u as e,j as s}from"./index-DXT0uy8Q.js";import{r as a}from"./react-vendor-B4Ig0bS4.js";import{a as i,d as l}from"./api-BZlasLbO.js";import{S as t}from"./SEO-ZFGY5Fm-.js";import"./ui-vendor-B5K7MVzt.js";const n=()=>{var n;const{playLiveStream:o,playEpisode:r,isPlaying:c,isLive:d}=e(),[m,u]=a.useState([]),[h,v]=a.useState([]),[p,x]=a.useState(null),[j,N]=a.useState(!0),[b,y]=a.useState("all"),[g,L]=a.useState("");a.useEffect(()=>{f()},[]),a.useEffect(()=>{w()},[m,b,g]);const f=async()=>{try{N(!0);const[e,s]=await Promise.all([i({limit:50,sort:"published_at",order:"desc"}),l().catch(()=>({is_live:!1}))]);u(e),x(s)}catch(e){}finally{N(!1)}},w=()=>{let e=m;if("all"!==b&&(e=e.filter(e=>e.category===b)),g.trim()){const s=g.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(s)||e.description.toLowerCase().includes(s)||e.show_title.toLowerCase().includes(s))}v(e)},_=e=>{const s=Math.floor(e/3600),a=Math.floor(e%3600/60);return s>0?`${s}h ${a}m`:`${a}m`},S=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return s.jsxs("div",{className:"listen-page",children:[s.jsx(t,{title:"Listen Live",description:"Listen to Resistance Radio live or explore our on-demand library of episodes. Amplifying truth, courage, and community across Zimbabwe and the diaspora.",keywords:["listen live","radio stream","on-demand","podcasts","zimbabwe radio"],url:"/listen"}),s.jsxs("div",{className:"container",children:[s.jsx("h1",{children:"Listen Live"}),s.jsx("section",{className:"live-player",children:s.jsxs("div",{className:"player-container",children:[s.jsx("div",{className:"now-playing",children:(null==p?void 0:p.is_live)?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"live-indicator",children:"● LIVE"}),s.jsxs("span",{className:"show-name",children:["Now Playing: ",(null==(n=p.current_show)?void 0:n.title)||"Live Broadcast"]})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"offline-indicator",children:"○ OFFLINE"}),s.jsx("span",{className:"show-name",children:"No live broadcast currently"})]})}),s.jsx("button",{className:"btn btn-primary listen-live-btn",onClick:()=>{(null==p?void 0:p.stream_url)&&o(p.stream_url)},disabled:!(null==p?void 0:p.is_live),children:(null==p?void 0:p.is_live)&&d&&c?"Listening Live":"Listen Live"}),(null==p?void 0:p.next_broadcast)&&s.jsxs("p",{className:"next-broadcast",children:["Next broadcast: ",(C=p.next_broadcast.scheduled_time,new Date(C).toLocaleString("en-US",{weekday:"long",hour:"numeric",minute:"2-digit",hour12:!0}))]})]})}),s.jsxs("section",{className:"on-demand",children:[s.jsx("h2",{children:"On-Demand Library"}),s.jsx("p",{className:"intro",children:"Browse and search past episodes"}),s.jsxs("div",{className:"controls",children:[s.jsx("div",{className:"search-box",children:s.jsx("input",{type:"text",placeholder:"Search episodes...",value:g,onChange:e=>L(e.target.value),className:"search-input"})}),s.jsx("div",{className:"category-filter",children:[{value:"all",label:"All Episodes"},{value:"civic_education",label:"Civic Education"},{value:"youth_voices",label:"Youth Voices"},{value:"diaspora",label:"Diaspora"},{value:"constitutional_literacy",label:"Constitutional Literacy"},{value:"investigative",label:"Investigative"},{value:"community_stories",label:"Community Stories"}].map(e=>s.jsx("button",{className:"filter-btn "+(b===e.value?"active":""),onClick:()=>y(e.value),children:e.label},e.value))})]}),j?s.jsx("div",{className:"loading",children:"Loading episodes..."}):0===h.length?s.jsx("div",{className:"no-episodes",children:g||"all"!==b?"No episodes found matching your criteria.":"No episodes available yet."}):s.jsx("div",{className:"episodes-grid",children:h.map(e=>s.jsxs("div",{className:"episode-card",children:[s.jsxs("div",{className:"episode-header",children:[s.jsx("span",{className:"show-badge",children:e.show_title}),s.jsx("span",{className:"episode-date",children:S(e.published_at)})]}),s.jsx("h3",{children:e.title}),s.jsx("p",{className:"episode-description",children:e.description}),s.jsxs("div",{className:"episode-footer",children:[s.jsx("span",{className:"episode-duration",children:_(e.duration)}),s.jsx("button",{className:"btn btn-small",onClick:()=>(e=>{r({title:e.title,showTitle:e.show_title,audioUrl:e.audio_url,isLive:!1})})(e),children:"▶ Play"})]})]},e.id))})]})]})]});var C};export{n as default};
